<!DOCTYPE html>
<html>
<head>
  <title></title>
  <script>
    var connected = false,
    gp, connIndex = -1, loop;
    document.addEventListener("DOMContentLoaded", function() {
      var loop = setInterval(checkHasGamepads, 100);
      updateStatus();
    });

    function checkHasGamepads() {
      gp = navigator.getGamepads();
      var pre = connected;
      connIndex = -1;
      var i = 0;
      var hadConn;
      for(var key of gp) {
        if(key != undefined && key != "length") {
          hadConn = true;
          connIndex = i;
          connected = true;
          break;
        }
        i++;
      }
      if(!hadConn)
        connected = false;
      if(connected != pre)
        updateStatus();
      if(connected) {
        sendStatus();
      }
    }

    function getStatus() {
      var controller = navigator.getGamepads()[connIndex];
      var direction;
      if(controller.axes[0] == 0 || Math.abs(controller.axes[0]) < 0.15) {
        direction = 0;
      } else if(controller.axes[0] > 0) {
        direction = 1;
      } else {
        direction = 0;
      }
      var acceleration;
      if(controller.buttons[7].pressed) {
        acceleration = 1;
      } else if (controller.buttons[6].pressed) {
        acceleration = -1;
      } else {
        acceleration = 0;
      }
    }

    function updateStatus() {
      document.body.innerHTML = connected ? (`Gamepad ${connIndex + 1} Connected`) : "Disconnected";
    }
  </script>
</head>
<body>
</body>
</html>
